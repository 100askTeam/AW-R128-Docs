import{_ as e,r as o,o as l,c as r,a as s,b as n,d as p,e as t}from"./app-e85d5a28.js";const c={},i=t('<h1 id="r128使用spi-lcd" tabindex="-1"><a class="header-anchor" href="#r128使用spi-lcd" aria-hidden="true">#</a> R128使用SPI LCD</h1><p>R128 平台提供了 SPI DBI 的 SPI TFT 接口，具有如下特点：</p><ul><li>Supports DBI Type C 3 Line/4 Line Interface Mode</li><li>Supports 2 Data Lane Interface Mode</li><li>Supports data source from CPU or DMA</li><li>Supports RGB111/444/565/666/888 video format</li><li>Maximum resolution of RGB666 240 x 320@30Hz with single data lane</li><li>Maximum resolution of RGB888 240 x 320@60Hz or 320 x 480@30Hz with dual data lane</li><li>Supports tearing effect</li><li>Supports software flexible control video frame rate</li></ul><p>同时，提供了SPILCD驱动框架以供 SPI 屏幕使用。</p><p>这里的示例以百问网的SPI LCD为例。</p><p>屏幕获取：</p>',6),d={href:"https://item.taobao.com/item.htm?id=736154682975",target:"_blank",rel:"noopener noreferrer"},k={href:"https://item.taobao.com/item.htm?&id=707079371679",target:"_blank",rel:"noopener noreferrer"},u=t(`<h2 id="接线" tabindex="-1"><a class="header-anchor" href="#接线" aria-hidden="true">#</a> 接线</h2><table><thead><tr><th style="text-align:left;">LCD Pin</th><th style="text-align:left;">R128 Pin</th></tr></thead><tbody><tr><td style="text-align:left;">GND</td><td style="text-align:left;">GND</td></tr><tr><td style="text-align:left;">PWM</td><td style="text-align:left;">PA26</td></tr><tr><td style="text-align:left;">RESET</td><td style="text-align:left;">PA05</td></tr><tr><td style="text-align:left;">MOSI</td><td style="text-align:left;">PA18</td></tr><tr><td style="text-align:left;">SCK</td><td style="text-align:left;">PA13</td></tr><tr><td style="text-align:left;">RS</td><td style="text-align:left;">PA04</td></tr><tr><td style="text-align:left;">CS</td><td style="text-align:left;">PA12</td></tr><tr><td style="text-align:left;">MISO</td><td style="text-align:left;">PA21</td></tr><tr><td style="text-align:left;">3.3V</td><td style="text-align:left;">3.3V</td></tr><tr><td style="text-align:left;">GND</td><td style="text-align:left;">GND</td></tr></tbody></table><h2 id="覆盖spilcd目录" tabindex="-1"><a class="header-anchor" href="#覆盖spilcd目录" aria-hidden="true">#</a> 覆盖spilcd目录</h2><p>将此目录下的名为<code>spilcd</code>的文件夹，复制覆盖到SDK中位于<code>R128-FreeRTOS/lichee/rtos-hal/hal/source/spilcd</code>的目录。</p><h2 id="配置menuconfig" tabindex="-1"><a class="header-anchor" href="#配置menuconfig" aria-hidden="true">#</a> 配置menuconfig</h2><p>初始化环境变量，选择方案，进入到menuconfig：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>100ask@100ask:~/R128-FreeRTOS/SDK$ <span class="token builtin class-name">source</span> envsetup.sh 
Setup <span class="token function">env</span> done<span class="token operator">!</span>
Run lunch_rtos to <span class="token keyword">select</span> project
100ask@100ask:~/R128-FreeRTOS/SDK$ lunch_rtos
<span class="token assign-left variable">last</span><span class="token operator">=</span>r128s2_devkit_c906

You<span class="token string">&#39;re building on Linux

Lunch menu... pick a combo:
     1. r128s2_devkit_c906
     2. r128s2_devkit_m33
     3. r128s2_devkit_rgb_c906
     4. r128s2_devkit_rgb_m33
     5. r128s2_evt_c906
     6. r128s2_evt_m33

Which would you like? [Default r128s2_devkit_c906]: 1
select=1...
r128s2/devkit_c906
&#39;</span>/home/100ask/R128-FreeRTOS/SDK/lichee/rtos/projects/r128s2/devkit_c906/defconfig<span class="token string">&#39; -&gt; &#39;</span>/home/100ask/R128-FreeRTOS/SDK/lichee/rtos/.config&#39;
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
<span class="token assign-left variable">RTOS_BUILD_TOP</span><span class="token operator">=</span>/home/100ask/R128-FreeRTOS/SDK
<span class="token assign-left variable">RTOS_TARGET_ARCH</span><span class="token operator">=</span>riscv
<span class="token assign-left variable">RTOS_TARGET_CHIP</span><span class="token operator">=</span>sun20iw2p1
<span class="token assign-left variable">RTOS_TARGET_DEVICE</span><span class="token operator">=</span>r128s2
<span class="token assign-left variable">RTOS_PROJECT_NAME</span><span class="token operator">=</span>r128s2_devkit_c906
<span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span><span class="token operator">==</span>
Run mrtos_menuconfig to config rtos
Run m or mrtos to build rtos
100ask@100ask:~/R128-FreeRTOS/SDK$
100ask@100ask:~/R128-FreeRTOS/SDK$
100ask@100ask:~/R128-FreeRTOS/SDK$ mrtos_menuconfig
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>menuconfig具体配置：</p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>
<span class="token comment"># 1.打开SPI和PWM</span>
Drivers Options  ---<span class="token operator">&gt;</span>
    soc related device drivers  ---<span class="token operator">&gt;</span>
        SPI Devices   ---<span class="token operator">&gt;</span>
            <span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token builtin class-name">enable</span> spi driver
            <span class="token punctuation">[</span>*<span class="token punctuation">]</span>   support sp transfer <span class="token keyword">if</span> crash
            <span class="token punctuation">[</span> <span class="token punctuation">]</span>   <span class="token builtin class-name">enable</span> spi hal APIs <span class="token builtin class-name">test</span> <span class="token builtin class-name">command</span>
        PWM devices ---<span class="token operator">&gt;</span>
            <span class="token punctuation">[</span>*<span class="token punctuation">]</span> <span class="token builtin class-name">enable</span> pwm driver
            <span class="token punctuation">[</span> <span class="token punctuation">]</span>   <span class="token builtin class-name">enable</span> pwm hal APIs <span class="token builtin class-name">test</span> <span class="token builtin class-name">command</span>

<span class="token comment"># 2. 打开SPILCD，并打开100ASK相关的配置</span>
Drivers Options  ---<span class="token operator">&gt;</span>
    soc related device drivers  ---<span class="token operator">&gt;</span>
        SPILCD Devices   ---<span class="token operator">&gt;</span>
            <span class="token punctuation">[</span>*<span class="token punctuation">]</span> DISP Driver Support<span class="token punctuation">(</span>spi_lcd<span class="token punctuation">)</span>
            <span class="token punctuation">[</span>*<span class="token punctuation">]</span>   spilcd hal APIs <span class="token builtin class-name">test</span>
            LCD_FB panels <span class="token keyword">select</span>  ---<span class="token operator">&gt;</span>
                <span class="token punctuation">[</span> <span class="token punctuation">]</span> LCD support kld2844B panel
                <span class="token punctuation">[</span> <span class="token punctuation">]</span> LCD support kld35512 panel
                <span class="token punctuation">[</span> <span class="token punctuation">]</span> LCD support kld39501 panel
                <span class="token punctuation">[</span> <span class="token punctuation">]</span> LCD support nv3029s panel
                <span class="token punctuation">[</span> <span class="token punctuation">]</span> LCD support JLT35031C panel
                100ASK LCD configure  ---<span class="token operator">&gt;</span>
                    <span class="token punctuation">[</span>*<span class="token punctuation">]</span> LCD support 100ask panel
                    Select the model of the display <span class="token punctuation">(</span>320X480<span class="token punctuation">)</span>  ---<span class="token operator">&gt;</span>
                    <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span> Set display rotation angle <span class="token punctuation">(</span><span class="token number">90</span>, <span class="token number">180</span>, <span class="token number">270</span><span class="token punctuation">)</span>
            Board <span class="token keyword">select</span>  ---<span class="token operator">&gt;</span>
                <span class="token punctuation">[</span> <span class="token punctuation">]</span> board kld2844b support
                <span class="token punctuation">[</span> <span class="token punctuation">]</span> board kld35512 support
                <span class="token punctuation">[</span>*<span class="token punctuation">]</span> board lcd 100ask support

<span class="token comment"># 3. 打开LVGL相关配置</span>
System components  ---<span class="token operator">&gt;</span>
    thirdparty components  ---<span class="token operator">&gt;</span>
        <span class="token punctuation">[</span>*<span class="token punctuation">]</span> Littlevgl-8  ---<span class="token operator">&gt;</span>
            --- Littlevgl-8
            <span class="token punctuation">[</span>*<span class="token punctuation">]</span>   lvgl examples
            <span class="token punctuation">[</span> <span class="token punctuation">]</span>   lvgl g2d <span class="token builtin class-name">test</span>
            <span class="token punctuation">[</span>*<span class="token punctuation">]</span>   lvgl-8.1.0 use sunxifb double buffer
            <span class="token punctuation">[</span>*<span class="token punctuation">]</span>   lvgl-8.1.0 use sunxifb cache
            <span class="token punctuation">[</span> <span class="token punctuation">]</span>   lvgl-8.1.0 use sunxifb g2d
            <span class="token punctuation">[</span> <span class="token punctuation">]</span>   lvgl-8.1.0 use sunxifb g2d rotate
            <span class="token punctuation">[</span> <span class="token punctuation">]</span>   lvgl-8.1.0 use freetype
            <span class="token punctuation">[</span> <span class="token punctuation">]</span>   lvgl-8.1.0 use direct mode
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="修改调试等级" tabindex="-1"><a class="header-anchor" href="#修改调试等级" aria-hidden="true">#</a> 修改调试等级</h2><p>修改文件：<code>R128-FreeRTOS/lichee/rtos-hal/hal/source/spi/hal_spi.c</code></p><p>SPI 驱动中预留了 3 个调试宏开关，可以根据需求相应开启。</p><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code>	<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SPI_INFO_LEVEL</span>    <span class="token expression"># 开启后驱动会将一些调试信息打印到串口终端上。</span></span>
	<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SPI_DATA_LEVEL</span>    <span class="token expression"># 开启后驱动会将 RX<span class="token operator">/</span>TX buffer 中的数据打印到串口终端上方便观察。</span></span>
	<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">SPI_DUMPREG_LEVEL</span> <span class="token expression"># 开启后驱动会在 RX<span class="token operator">/</span>TX 时分别 dump 一次 SPI 的寄存器信息并打印到串口终端上方便观察。</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="修改默认align-dma-buf-size" tabindex="-1"><a class="header-anchor" href="#修改默认align-dma-buf-size" aria-hidden="true">#</a> 修改默认ALIGN_DMA_BUF_SIZE</h2><p>修改文件：<code>R128-FreeRTOS/lichee/rtos-hal/include/hal/sunxi_hal_spi.h</code></p><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifdef</span> <span class="token expression">CONFIG_USE_100ASK_DISPLAY_SCREEN_240X240</span></span>
	<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">ALIGN_DMA_BUF_SIZE</span> <span class="token expression"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">240</span><span class="token operator">*</span><span class="token number">240</span><span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">64</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">elif</span> <span class="token expression">CONFIG_USE_100ASK_DISPLAY_SCREEN_320X480</span></span>
	<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">ALIGN_DMA_BUF_SIZE</span> <span class="token expression"><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">320</span><span class="token operator">*</span><span class="token number">480</span><span class="token operator">*</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token number">64</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">else</span></span>
	<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">ALIGN_DMA_BUF_SIZE</span> <span class="token expression"><span class="token punctuation">(</span><span class="token number">4096</span> <span class="token operator">+</span> <span class="token number">64</span><span class="token punctuation">)</span></span></span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="注释support-dbi-if" tabindex="-1"><a class="header-anchor" href="#注释support-dbi-if" aria-hidden="true">#</a> 注释SUPPORT_DBI_IF</h2><p>修改文件：<code>R128-FreeRTOS/lichee/rtos-hal/hal/source/spilcd/lcd_fb/lcd_fb_feature.h</code></p><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span> <span class="token expression"><span class="token function">defined</span> <span class="token punctuation">(</span>CONFIG_ARCH_SUN50IW11<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">defined</span><span class="token punctuation">(</span>CONFIG_ARCH_SUN8IW20<span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token function">defined</span><span class="token punctuation">(</span>CONFIG_ARCH_SUN20IW1<span class="token punctuation">)</span> </span><span class="token punctuation">\\</span>
        <span class="token expression"><span class="token operator">||</span> <span class="token function">defined</span><span class="token punctuation">(</span>CONFIG_ARCH_SUN20IW2<span class="token punctuation">)</span></span></span>
<span class="token comment">//#define SUPPORT_DBI_IF</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="sys-config-fex配置" tabindex="-1"><a class="header-anchor" href="#sys-config-fex配置" aria-hidden="true">#</a> sys_config.fex配置</h2><p>修改文件：<code>R128-FreeRTOS/board/r128s2/pro/configs/sys_config.fex</code></p><div class="language-bash line-numbers-mode" data-ext="sh"><pre class="language-bash"><code>
<span class="token punctuation">;</span>----------------------------------------------------------------------------------
<span class="token punctuation">;</span>SPI controller configuration
<span class="token punctuation">;</span>----------------------------------------------------------------------------------
<span class="token punctuation">;</span>Please config spi <span class="token keyword">in</span> dts
<span class="token punctuation">[</span>spi1<span class="token punctuation">]</span>
spi1_used       <span class="token operator">=</span> <span class="token number">1</span>
spi1_cs_number  <span class="token operator">=</span> <span class="token number">1</span>
spi1_cs_bitmap  <span class="token operator">=</span> <span class="token number">1</span>
spi1_cs0        <span class="token operator">=</span> port:PA1<span class="token operator"><span class="token file-descriptor important">2</span>&lt;</span><span class="token operator"><span class="token file-descriptor important">6</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token operator">&lt;</span>default<span class="token operator">&gt;</span>
spi1_sclk       <span class="token operator">=</span> port:PA1<span class="token operator"><span class="token file-descriptor important">3</span>&lt;</span><span class="token operator"><span class="token file-descriptor important">6</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token operator">&lt;</span>default<span class="token operator">&gt;</span>
spi1_mosi       <span class="token operator">=</span> port:PA1<span class="token operator"><span class="token file-descriptor important">8</span>&lt;</span><span class="token operator"><span class="token file-descriptor important">6</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token operator">&lt;</span>default<span class="token operator">&gt;</span>
spi1_miso       <span class="token operator">=</span> port:PA2<span class="token operator"><span class="token file-descriptor important">1</span>&lt;</span><span class="token operator"><span class="token file-descriptor important">6</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token operator">&lt;</span>default<span class="token operator">&gt;</span>
spi1_hold       <span class="token operator">=</span> port:PA1<span class="token operator"><span class="token file-descriptor important">9</span>&lt;</span><span class="token operator"><span class="token file-descriptor important">6</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token operator">&lt;</span>default<span class="token operator">&gt;</span>
spi1_wp         <span class="token operator">=</span> port:PA2<span class="token operator"><span class="token file-descriptor important">0</span>&lt;</span><span class="token operator"><span class="token file-descriptor important">6</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token operator">&lt;</span>default<span class="token operator">&gt;</span>

<span class="token punctuation">[</span>pwm6<span class="token punctuation">]</span>
pwm_used        <span class="token operator">=</span> <span class="token number">1</span>
pwm_positive    <span class="token operator">=</span> port:PA2<span class="token operator"><span class="token file-descriptor important">6</span>&lt;</span><span class="token operator"><span class="token file-descriptor important">4</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token operator">&lt;</span>default<span class="token operator">&gt;</span>

<span class="token punctuation">;</span>----------------------------------------------------------------------------------
<span class="token punctuation">;</span>lcd_fb0 configuration
<span class="token punctuation">;</span>----------------------------------------------------------------------------------

<span class="token punctuation">[</span>lcd_fb0<span class="token punctuation">]</span>
lcd_used            <span class="token operator">=</span> <span class="token number">1</span>
lcd_model_name      <span class="token operator">=</span> <span class="token string">&quot;spilcd&quot;</span>
lcd_driver_name     <span class="token operator">=</span> <span class="token string">&quot;lcd_100ask_spi&quot;</span>
lcd_x               <span class="token operator">=</span> <span class="token number">320</span>
lcd_y               <span class="token operator">=</span> <span class="token number">480</span>
lcd_width           <span class="token operator">=</span> <span class="token number">49</span>
lcd_height          <span class="token operator">=</span> <span class="token number">73</span>
lcd_data_speed      <span class="token operator">=</span> <span class="token number">65</span>
lcd_pwm_used        <span class="token operator">=</span> <span class="token number">1</span>
lcd_pwm_ch          <span class="token operator">=</span> <span class="token number">6</span>
lcd_pwm_freq        <span class="token operator">=</span> <span class="token number">5000</span>
lcd_pwm_pol         <span class="token operator">=</span> <span class="token number">0</span>
lcd_if              <span class="token operator">=</span> <span class="token number">0</span>
lcd_pixel_fmt       <span class="token operator">=</span> <span class="token number">11</span>
lcd_dbi_fmt         <span class="token operator">=</span> <span class="token number">2</span>
lcd_dbi_clk_mode    <span class="token operator">=</span> <span class="token number">1</span>
lcd_dbi_te          <span class="token operator">=</span> <span class="token number">1</span>
fb_buffer_num       <span class="token operator">=</span> <span class="token number">2</span>
lcd_dbi_if          <span class="token operator">=</span> <span class="token number">4</span>
lcd_rgb_order       <span class="token operator">=</span> <span class="token number">0</span>
lcd_fps             <span class="token operator">=</span> <span class="token number">10</span>
lcd_spi_bus_num     <span class="token operator">=</span> <span class="token number">1</span>
lcd_frm             <span class="token operator">=</span> <span class="token number">2</span>
lcd_gamma_en        <span class="token operator">=</span> <span class="token number">1</span>
lcd_backlight       <span class="token operator">=</span> <span class="token number">100</span>

lcd_power_num       <span class="token operator">=</span> <span class="token number">0</span>
lcd_gpio_regu_num   <span class="token operator">=</span> <span class="token number">0</span>
lcd_bl_percent_num  <span class="token operator">=</span> <span class="token number">0</span>

<span class="token punctuation">;</span><span class="token punctuation">;</span>lcd_spi_dc_pin      <span class="token operator">=</span> port:PA1<span class="token operator"><span class="token file-descriptor important">9</span>&lt;</span><span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>
lcd_spi_dc_pin      <span class="token operator">=</span> port:PA0<span class="token operator"><span class="token file-descriptor important">4</span>&lt;</span><span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>
<span class="token punctuation">;</span>lcd_gpio_0          <span class="token operator">=</span> port:PA1<span class="token operator"><span class="token file-descriptor important">2</span>&lt;</span><span class="token operator"><span class="token file-descriptor important">1</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">2</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>



<span class="token punctuation">;</span>----------------------------------------------------------------------------------
<span class="token punctuation">;</span>lcd0 configuration

<span class="token punctuation">;</span>lcd_if:               <span class="token number">0</span>:hv<span class="token punctuation">(</span>sync+de<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token number">1</span>:8080<span class="token punctuation">;</span> <span class="token number">2</span>:ttl<span class="token punctuation">;</span> <span class="token number">3</span>:lvds<span class="token punctuation">;</span> <span class="token number">4</span>:dsi<span class="token punctuation">;</span> <span class="token number">5</span>:edp<span class="token punctuation">;</span> <span class="token number">6</span>:extend dsi
<span class="token punctuation">;</span>lcd_x:                lcd horizontal resolution
<span class="token punctuation">;</span>lcd_y:                lcd vertical resolution
<span class="token punctuation">;</span>lcd_width:            width of lcd <span class="token keyword">in</span> mm
<span class="token punctuation">;</span>lcd_height:           height of lcd <span class="token keyword">in</span> mm
<span class="token punctuation">;</span>lcd_dclk_freq:        <span class="token keyword">in</span> MHZ unit
<span class="token punctuation">;</span>lcd_pwm_freq:         <span class="token keyword">in</span> HZ unit
<span class="token punctuation">;</span>lcd_pwm_pol:          lcd backlight PWM polarity
<span class="token punctuation">;</span>lcd_pwm_max_limit     lcd backlight PWM max limit<span class="token punctuation">(</span><span class="token operator">&lt;=</span><span class="token number">255</span><span class="token punctuation">)</span>
<span class="token punctuation">;</span>lcd_hbp:              hsync back porch
<span class="token punctuation">;</span>lcd_ht:               hsync total cycle
<span class="token punctuation">;</span>lcd_vbp:              vsync back porch
<span class="token punctuation">;</span>lcd_vt:               vysnc total cycle
<span class="token punctuation">;</span>lcd_hspw:             hsync plus width
<span class="token punctuation">;</span>lcd_vspw:             vysnc plus width
<span class="token punctuation">;</span>lcd_lvds_if:          <span class="token number">0</span>:single <span class="token function">link</span><span class="token punctuation">;</span>  <span class="token number">1</span>:dual <span class="token function">link</span>
<span class="token punctuation">;</span>lcd_lvds_colordepth:  <span class="token number">0</span>:8bit<span class="token punctuation">;</span> <span class="token number">1</span>:6bit
<span class="token punctuation">;</span>lcd_lvds_mode:        <span class="token number">0</span>:NS mode<span class="token punctuation">;</span> <span class="token number">1</span>:JEIDA mode
<span class="token punctuation">;</span>lcd_frm:              <span class="token number">0</span>:disable<span class="token punctuation">;</span> <span class="token number">1</span>:enable rgb666 dither<span class="token punctuation">;</span> <span class="token number">2</span>:enable rgb656 dither
<span class="token punctuation">;</span>lcd_io_phase:         <span class="token number">0</span>:noraml<span class="token punctuation">;</span> <span class="token number">1</span>:intert phase<span class="token punctuation">(</span><span class="token number">0</span>~3bit: vsync phase<span class="token punctuation">;</span> <span class="token number">4</span>~7bit:hsync phase<span class="token punctuation">;</span>
<span class="token punctuation">;</span>                      <span class="token number">8</span>~11bit:dclk phase<span class="token punctuation">;</span> <span class="token number">12</span>~15bit:de phase<span class="token punctuation">)</span>
<span class="token punctuation">;</span>lcd_gamma_en          lcd gamma correction <span class="token builtin class-name">enable</span>
<span class="token punctuation">;</span>lcd_bright_curve_en   lcd bright curve correction <span class="token builtin class-name">enable</span>
<span class="token punctuation">;</span>lcd_cmap_en           lcd color map <span class="token keyword">function</span> <span class="token builtin class-name">enable</span>
<span class="token punctuation">;</span>deu_mode              <span class="token number">0</span>:smoll lcd <span class="token function">screen</span><span class="token punctuation">;</span> <span class="token number">1</span>:large lcd screen<span class="token punctuation">(</span>larger than 10inch<span class="token punctuation">)</span>
<span class="token punctuation">;</span>lcdgamma4iep:         Smart Backlight parameter, lcd gamma vale * <span class="token number">10</span><span class="token punctuation">;</span>
<span class="token punctuation">;</span>                      decrease it <span class="token keyword">while</span> lcd is not bright enough<span class="token punctuation">;</span> increase <span class="token keyword">while</span> lcd is too bright
<span class="token punctuation">;</span>smart_color           <span class="token number">90</span>:normal lcd <span class="token function">screen</span> <span class="token number">65</span>:retina lcd screen<span class="token punctuation">(</span><span class="token number">9</span>.7inch<span class="token punctuation">)</span>
<span class="token punctuation">;</span>----------------------------------------------------------------------------------
<span class="token punctuation">;</span><span class="token punctuation">[</span>lcd0<span class="token punctuation">]</span>
<span class="token punctuation">;</span>lcd_used            <span class="token operator">=</span> <span class="token number">1</span>
<span class="token punctuation">;</span>
<span class="token punctuation">;</span>lcd_driver_name     <span class="token operator">=</span> <span class="token string">&quot;default_lcd&quot;</span>
<span class="token punctuation">;</span>lcd_backlight       <span class="token operator">=</span> <span class="token number">150</span>
<span class="token punctuation">;</span>lcd_if              <span class="token operator">=</span> <span class="token number">0</span>
<span class="token punctuation">;</span>lcd_x               <span class="token operator">=</span> <span class="token number">800</span>
<span class="token punctuation">;</span>lcd_y               <span class="token operator">=</span> <span class="token number">480</span>
<span class="token punctuation">;</span>lcd_width           <span class="token operator">=</span> <span class="token number">150</span>
<span class="token punctuation">;</span>lcd_height          <span class="token operator">=</span> <span class="token number">94</span>
<span class="token punctuation">;</span>lcd_rb_swap         <span class="token operator">=</span> <span class="token number">0</span>
<span class="token punctuation">;</span>lcd_dclk_freq       <span class="token operator">=</span> <span class="token number">33</span>
<span class="token punctuation">;</span>lcd_pwm_used        <span class="token operator">=</span> <span class="token number">1</span>
<span class="token punctuation">;</span>lcd_pwm_ch          <span class="token operator">=</span> <span class="token number">6</span>
<span class="token punctuation">;</span>lcd_pwm_freq        <span class="token operator">=</span> <span class="token number">5000</span>
<span class="token punctuation">;</span>lcd_pwm_pol         <span class="token operator">=</span> <span class="token number">1</span>
<span class="token punctuation">;</span>lcd_hbp             <span class="token operator">=</span> <span class="token number">46</span>
<span class="token punctuation">;</span>lcd_ht              <span class="token operator">=</span> <span class="token number">1055</span>
<span class="token punctuation">;</span>lcd_hspw            <span class="token operator">=</span> <span class="token number">0</span>
<span class="token punctuation">;</span>lcd_vbp             <span class="token operator">=</span> <span class="token number">23</span>
<span class="token punctuation">;</span>lcd_vt              <span class="token operator">=</span> <span class="token number">525</span>
<span class="token punctuation">;</span>lcd_vspw            <span class="token operator">=</span> <span class="token number">0</span>
<span class="token punctuation">;</span>lcd_lvds_if         <span class="token operator">=</span> <span class="token number">0</span>
<span class="token punctuation">;</span>lcd_lvds_colordepth <span class="token operator">=</span> <span class="token number">1</span>
<span class="token punctuation">;</span>lcd_lvds_mode       <span class="token operator">=</span> <span class="token number">0</span>
<span class="token punctuation">;</span>lcd_frm             <span class="token operator">=</span> <span class="token number">0</span>
<span class="token punctuation">;</span>lcd_io_phase        <span class="token operator">=</span> 0x0000
<span class="token punctuation">;</span>lcd_gamma_en        <span class="token operator">=</span> <span class="token number">0</span>
<span class="token punctuation">;</span>lcd_bright_curve_en <span class="token operator">=</span> <span class="token number">0</span>
<span class="token punctuation">;</span>lcd_cmap_en         <span class="token operator">=</span> <span class="token number">0</span>
<span class="token punctuation">;</span>
<span class="token punctuation">;</span>deu_mode            <span class="token operator">=</span> <span class="token number">0</span>
<span class="token punctuation">;</span>lcdgamma4iep        <span class="token operator">=</span> <span class="token number">22</span>
<span class="token punctuation">;</span>smart_color         <span class="token operator">=</span> <span class="token number">90</span>
<span class="token punctuation">;</span>
<span class="token punctuation">;</span><span class="token punctuation">;</span>LCD_D2-LCD_D7
<span class="token punctuation">;</span>lcd_gpio_0               <span class="token operator">=</span> port:PA0<span class="token operator"><span class="token file-descriptor important">0</span>&lt;</span><span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>
<span class="token punctuation">;</span>lcd_gpio_1               <span class="token operator">=</span> port:PA0<span class="token operator"><span class="token file-descriptor important">1</span>&lt;</span><span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>
<span class="token punctuation">;</span>lcd_gpio_2               <span class="token operator">=</span> port:PA0<span class="token operator"><span class="token file-descriptor important">2</span>&lt;</span><span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>
<span class="token punctuation">;</span>lcd_gpio_3               <span class="token operator">=</span> port:PA0<span class="token operator"><span class="token file-descriptor important">3</span>&lt;</span><span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>
<span class="token punctuation">;</span>lcd_gpio_4               <span class="token operator">=</span> port:PA0<span class="token operator"><span class="token file-descriptor important">4</span>&lt;</span><span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>
<span class="token punctuation">;</span>lcd_gpio_5               <span class="token operator">=</span> port:PA0<span class="token operator"><span class="token file-descriptor important">5</span>&lt;</span><span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>
<span class="token punctuation">;</span>
<span class="token punctuation">;</span><span class="token punctuation">;</span>LCD_D10-LCD_D15
<span class="token punctuation">;</span>lcd_gpio_6               <span class="token operator">=</span> port:PA1<span class="token operator"><span class="token file-descriptor important">1</span>&lt;</span><span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>
<span class="token punctuation">;</span>lcd_gpio_7               <span class="token operator">=</span> port:PA1<span class="token operator"><span class="token file-descriptor important">0</span>&lt;</span><span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>
<span class="token punctuation">;</span>lcd_gpio_8               <span class="token operator">=</span> port:PA0<span class="token operator"><span class="token file-descriptor important">8</span>&lt;</span><span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>
<span class="token punctuation">;</span>lcd_gpio_9               <span class="token operator">=</span> port:PA0<span class="token operator"><span class="token file-descriptor important">7</span>&lt;</span><span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>
<span class="token punctuation">;</span>lcd_gpio_10              <span class="token operator">=</span> port:PA0<span class="token operator"><span class="token file-descriptor important">6</span>&lt;</span><span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>
<span class="token punctuation">;</span>lcd_gpio_11              <span class="token operator">=</span> port:PA0<span class="token operator"><span class="token file-descriptor important">9</span>&lt;</span><span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>
<span class="token punctuation">;</span>
<span class="token punctuation">;</span><span class="token punctuation">;</span>LCD_D18-LCD_D23
<span class="token punctuation">;</span>lcd_gpio_12              <span class="token operator">=</span> port:PA1<span class="token operator"><span class="token file-descriptor important">2</span>&lt;</span><span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>
<span class="token punctuation">;</span>lcd_gpio_13              <span class="token operator">=</span> port:PA1<span class="token operator"><span class="token file-descriptor important">3</span>&lt;</span><span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>
<span class="token punctuation">;</span>lcd_gpio_14              <span class="token operator">=</span> port:PA1<span class="token operator"><span class="token file-descriptor important">4</span>&lt;</span><span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>
<span class="token punctuation">;</span>lcd_gpio_15              <span class="token operator">=</span> port:PA1<span class="token operator"><span class="token file-descriptor important">5</span>&lt;</span><span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>
<span class="token punctuation">;</span>lcd_gpio_16              <span class="token operator">=</span> port:PB0<span class="token operator"><span class="token file-descriptor important">3</span>&lt;</span><span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>
<span class="token punctuation">;</span>lcd_gpio_17              <span class="token operator">=</span> port:PB0<span class="token operator"><span class="token file-descriptor important">2</span>&lt;</span><span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>
<span class="token punctuation">;</span>
<span class="token punctuation">;</span><span class="token punctuation">;</span>LCD_VSYNC, LCD_HSYNC, LCD_DCLK, LCD_DE
<span class="token punctuation">;</span>lcd_gpio_18              <span class="token operator">=</span> port:PA1<span class="token operator"><span class="token file-descriptor important">8</span>&lt;</span><span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>
<span class="token punctuation">;</span>lcd_gpio_19              <span class="token operator">=</span> port:PA1<span class="token operator"><span class="token file-descriptor important">9</span>&lt;</span><span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>
<span class="token punctuation">;</span>lcd_gpio_20              <span class="token operator">=</span> port:PA2<span class="token operator"><span class="token file-descriptor important">0</span>&lt;</span><span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>
<span class="token punctuation">;</span>lcd_gpio_21              <span class="token operator">=</span> port:PA2<span class="token operator"><span class="token file-descriptor important">1</span>&lt;</span><span class="token operator"><span class="token file-descriptor important">8</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">3</span>&gt;</span><span class="token operator">&lt;</span><span class="token operator"><span class="token file-descriptor important">0</span>&gt;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="lvgl配置" tabindex="-1"><a class="header-anchor" href="#lvgl配置" aria-hidden="true">#</a> lvgl配置</h2><h3 id="修改lv-conf-h" tabindex="-1"><a class="header-anchor" href="#修改lv-conf-h" aria-hidden="true">#</a> 修改lv_conf.h</h3><p>修改文件：<code>SDK/lichee/rtos-components/thirdparty/littlevgl-8/lv_examples/src/lv_conf.h</code></p><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code><span class="token comment">/*====================
   COLOR SETTINGS
 *====================*/</span>

<span class="token comment">/*Color depth: 1 (1 byte per pixel), 8 (RGB332), 16 (RGB565), 32 (ARGB8888)*/</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">LV_COLOR_DEPTH</span> <span class="token expression"><span class="token number">16</span></span></span>

<span class="token comment">/*Swap the 2 bytes of RGB565 color. Useful if the display has an 8-bit interface (e.g. SPI)*/</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">define</span> <span class="token macro-name">LV_COLOR_16_SWAP</span> <span class="token expression"><span class="token number">1</span></span></span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h3 id="修改lv-main-c" tabindex="-1"><a class="header-anchor" href="#修改lv-main-c" aria-hidden="true">#</a> 修改lv_main.c</h3><p>修改文件：<code>SDK/lichee/rtos-components/thirdparty/littlevgl-8/lv_examples/src/lv_main.c</code></p><p>添加屏幕旋转处理：</p><div class="language-c line-numbers-mode" data-ext="c"><pre class="language-c"><code>    <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">&quot;sunxifb_get_sizes width:%d, height:%d, width * height * sizeof(lv_color_t):%d\\n&quot;</span><span class="token punctuation">,</span> width<span class="token punctuation">,</span> height<span class="token punctuation">,</span> width <span class="token operator">*</span> height <span class="token operator">*</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span><span class="token class-name">lv_color_t</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

    <span class="token comment">/*Initialize and register a display driver*/</span>
    <span class="token keyword">static</span> <span class="token class-name">lv_disp_drv_t</span> disp_drv<span class="token punctuation">;</span>
    <span class="token function">lv_disp_drv_init</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>disp_drv<span class="token punctuation">)</span><span class="token punctuation">;</span>
    disp_drv<span class="token punctuation">.</span>draw_buf   <span class="token operator">=</span> <span class="token operator">&amp;</span>disp_buf<span class="token punctuation">;</span>
    disp_drv<span class="token punctuation">.</span>flush_cb   <span class="token operator">=</span> sunxifb_flush<span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">if</span> <span class="token expression"><span class="token punctuation">(</span><span class="token punctuation">(</span>CONFIG_DISPLAY_SCREEN_100ASK_ROTATION <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>CONFIG_DISPLAY_SCREEN_100ASK_ROTATION <span class="token operator">==</span> <span class="token number">180</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>
    disp_drv<span class="token punctuation">.</span>hor_res    <span class="token operator">=</span> width<span class="token punctuation">;</span>
    disp_drv<span class="token punctuation">.</span>ver_res    <span class="token operator">=</span> height<span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">elif</span> <span class="token expression"><span class="token punctuation">(</span><span class="token punctuation">(</span>CONFIG_DISPLAY_SCREEN_100ASK_ROTATION <span class="token operator">==</span> <span class="token number">90</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token punctuation">(</span>CONFIG_DISPLAY_SCREEN_100ASK_ROTATION <span class="token operator">==</span> <span class="token number">270</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span>
    disp_drv<span class="token punctuation">.</span>hor_res    <span class="token operator">=</span> height<span class="token punctuation">;</span>
    disp_drv<span class="token punctuation">.</span>ver_res    <span class="token operator">=</span> width<span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">else</span></span>
    disp_drv<span class="token punctuation">.</span>hor_res    <span class="token operator">=</span> width<span class="token punctuation">;</span>
    disp_drv<span class="token punctuation">.</span>ver_res    <span class="token operator">=</span> height<span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>

    disp_drv<span class="token punctuation">.</span>rotated    <span class="token operator">=</span> rotated<span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">ifndef</span> <span class="token expression">USE_SUNXIFB_G2D_ROTATE</span></span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>rotated <span class="token operator">!=</span> LV_DISP_ROT_NONE<span class="token punctuation">)</span>
        disp_drv<span class="token punctuation">.</span>sw_rotate <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
<span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">endif</span></span>
    <span class="token function">lv_disp_drv_register</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>disp_drv<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="结果" tabindex="-1"><a class="header-anchor" href="#结果" aria-hidden="true">#</a> 结果</h2><p>以上配置完成后，编译打包烧录，上电后屏幕背光亮起，屏幕为黑色。</p><p><img src="http://photos.100ask.net/aw-r128-docs/rtos/demo/part1/chapter9/image12.png" alt=""></p><p>并且可以在 LOG 中看到 <code>[LCD_FB] lcd_fb_probe,line:103:</code> 和 <code>spi_clk_init()1609 [spi1] clk rate auto adjust to 48000000</code> SPI 初始化的 LOG。</p><p><img src="http://photos.100ask.net/aw-r128-docs/rtos/demo/part1/chapter9/image13.png" alt=""></p><p>然后可以用 <code>test_spilcd</code> 测试屏幕，日志如下</p><p><img src="http://photos.100ask.net/aw-r128-docs/rtos/demo/part1/chapter9/image14.png" alt=""></p><p>执行命令之后屏幕会变为黄色。</p>`,38),m={href:"https://aw-r128.100ask.net/zh/rtos/developer-guide/part1/chapter5.html#faq",target:"_blank",rel:"noopener noreferrer"},v=s("p",null,[s("img",{src:"http://photos.100ask.net/aw-r128-docs/rtos/demo/part1/chapter9/image15.png",alt:""})],-1),b=s("p",null,[s("code",null,"test_spilcd"),n(" 代码位于： "),s("code",null,"SDK/lichee/rtos-hal/hal/test/spilcd/test_spilcd.c")],-1),_=s("p",null,[n("也可以通过执行 "),s("strong",null,"lv_examples"),n(" 命令运行LVGL测试demo。")],-1),f=s("p",null,[s("code",null,"lv_examples"),n(" 代码位于： "),s("code",null,"SDK/lichee/rtos-components/thirdparty/littlevgl-8/lv_examples/src/lv_main.c")],-1);function g(h,S){const a=o("ExternalLinkIcon");return l(),r("div",null,[i,s("ul",null,[s("li",null,[s("a",d,[n("https://item.taobao.com/item.htm?id=736154682975"),p(a)])]),s("li",null,[n("或"),s("a",k,[n("https://item.taobao.com/item.htm?&id=707079371679"),p(a)])])]),u,s("ul",null,[s("li",null,[n("SPI 屏幕颜色说明：<"),s("a",m,[n("SPI LCD 显示驱动 - SPI LCD 颜色相关问题"),p(a)]),n(">")])]),v,b,_,f])}const x=e(c,[["render",g],["__file","chapter9.html.vue"]]);export{x as default};
